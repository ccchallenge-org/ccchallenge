<!-- Add Review Form (inline, inside paper detail) -->
<div x-data="{ showForm: false }" class="mt-3">
    <button @click="showForm = !showForm"
        class="text-xs text-blue-600 hover:text-blue-800 font-medium">
        + Add Review Link
    </button>
    <div x-show="showForm" x-cloak class="mt-2 bg-gray-50 rounded p-3">
        <form x-data="{ rd: { external_url: '', comment: '' } }"
              @submit.prevent="
                const payload = {external_url: rd.external_url};
                if (rd.comment) payload.comment = rd.comment;
                fetch('/api/papers/{{ paper.bibtex_key }}/reviews', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(payload)
                }).then(r => {
                    if(r.ok) htmx.ajax('GET', '/htmx/paper-detail/{{ paper.bibtex_key }}', {target: '#detail-{{ paper.bibtex_key }}', swap: 'innerHTML'});
                    else return r.json().then(d => alert(d.detail || 'Error'));
                })
              "
              class="space-y-2">
            <div>
                <label class="block text-xs font-medium text-gray-700">URL *</label>
                <input type="url" x-model="rd.external_url" required placeholder="https://..."
                    class="w-full rounded border-gray-300 text-gray-900 text-xs p-1.5 border">
            </div>
            <div>
                <label class="block text-xs font-medium text-gray-700">Comment</label>
                <input type="text" x-model="rd.comment" placeholder="Optional comment"
                    class="w-full rounded border-gray-300 text-gray-900 text-xs p-1.5 border">
            </div>
            <button type="submit"
                class="px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium rounded transition-colors">
                Add Link
            </button>
        </form>
    </div>
</div>
